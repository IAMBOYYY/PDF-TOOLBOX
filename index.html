<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Toolbox | Free PDF Tools</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #f8fafc;
        }

        .tool-tab {
            padding: 10px 16px;
            border-radius: 10px;
            background: #e5e7eb;
            font-weight: 700;
            transition: all 0.2s;
        }

        .tool-tab.active {
            background: #2563eb;
            color: white;
        }

        .tool-section {
            display: none;
        }

        .tool-section.active {
            display: block;
        }

        .upload-area {
            border: 2px dashed #94a3b8;
            cursor: pointer;
            transition: border-color 0.2s;
        }
        
        .upload-area:hover {
            border-color: #2563eb;
        }

        .btn-gradient {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
        }
        
        .btn-gradient:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>

<header class="bg-white border-b p-4 text-center font-bold text-2xl">
    PDF<span class="text-blue-600">Toolbox</span>
</header>

<main class="max-w-4xl mx-auto p-6">

    <!-- Tabs -->
    <div class="flex flex-wrap gap-2 mb-6 justify-center">
        <button class="tool-tab active" data-tool="merge">Merge</button>
        <button class="tool-tab" data-tool="split">Split</button>
        <button class="tool-tab" data-tool="compress">Compress</button>
        <button class="tool-tab" data-tool="convert">To Text</button>
    </div>

    <!-- MERGE -->
    <section id="merge" class="tool-section active">
        <div id="mergeDrop" class="upload-area p-10 text-center rounded-xl bg-white">
            <i class="fa-solid fa-file-pdf text-4xl text-blue-600 mb-2"></i><br>
            Click to upload PDFs
            <input id="mergeIn" type="file" multiple accept=".pdf" hidden>
        </div>

        <div id="mergeList" class="mt-4 space-y-2"></div>

        <button id="doMerge"
            class="btn-gradient w-full mt-4 py-3 text-white rounded-xl font-bold shadow-lg"
            disabled>
            Merge PDFs
        </button>
    </section>

    <!-- SPLIT -->
    <section id="split" class="tool-section">
        <div id="splitDrop" class="upload-area p-10 text-center rounded-xl bg-white">
            <i class="fa-solid fa-scissors text-4xl text-blue-600 mb-2"></i><br>
            Click to upload PDF
            <input id="splitIn" type="file" accept=".pdf" hidden>
        </div>
        <button id="doSplit" class="btn-gradient w-full mt-4 py-3 text-white rounded-xl font-bold shadow-lg hidden">
            Split PDF
        </button>
    </section>

    <!-- COMPRESS -->
    <section id="compress" class="tool-section">
        <div id="compDrop" class="upload-area p-10 text-center rounded-xl bg-white">
            <i class="fa-solid fa-compress text-4xl text-blue-600 mb-2"></i><br>
            Upload PDF
            <input id="compIn" type="file" accept=".pdf" hidden>
        </div>
        <button id="doComp" class="btn-gradient w-full mt-4 py-3 text-white rounded-xl font-bold shadow-lg hidden">
            Compress PDF
        </button>
    </section>

    <!-- CONVERT -->
    <section id="convert" class="tool-section">
        <div id="convDrop" class="upload-area p-10 text-center rounded-xl bg-white">
            <i class="fa-solid fa-file-lines text-4xl text-blue-600 mb-2"></i><br>
            Upload PDF
            <input id="convIn" type="file" accept=".pdf" hidden>
        </div>
        <button id="doConv" class="btn-gradient w-full mt-4 py-3 text-white rounded-xl font-bold shadow-lg hidden">
            Extract Text
        </button>
    </section>

</main>

<!-- Loader -->
<div id="loader" class="hidden fixed inset-0 bg-black/40 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-xl font-bold shadow-2xl flex flex-col items-center gap-4">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
        <div id="loaderText">Processing...</div>
    </div>
</div>

<!-- PDF LIBRARIES -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<script>
    const { PDFDocument } = PDFLib;

    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";

    /* ---------- HELPERS ---------- */
    const loader = document.getElementById("loader");
    const loaderText = document.getElementById("loaderText");

    const showLoader = t => {
      loaderText.innerText = t;
      loader.classList.remove("hidden");
    };
    const hideLoader = () => loader.classList.add("hidden");

    const saveFile = (data, name, blob = false) => {
      const file = blob ? data : new Blob([data], { type: "application/pdf" });
      const url = URL.createObjectURL(file);
      const a = document.createElement("a");
      a.href = url;
      a.download = name;
      a.click();
      URL.revokeObjectURL(url);
    };

    /* ---------- TABS ---------- */
    document.querySelectorAll(".tool-tab").forEach(tab => {
      tab.onclick = () => {
        document.querySelectorAll(".tool-tab,.tool-section")
          .forEach(el => el.classList.remove("active"));
        tab.classList.add("active");
        document.getElementById(tab.dataset.tool).classList.add("active");
      };
    });

    /* ---------- MERGE ---------- */
    let mergeFiles = [];
    const mIn = document.getElementById("mergeIn");
    const mDrop = document.getElementById("mergeDrop");
    const mList = document.getElementById("mergeList");
    const mBtn = document.getElementById("doMerge");

    mDrop.onclick = () => mIn.click();

    mIn.onchange = () => {
      mergeFiles.push(...mIn.files);
      renderMerge();
      mIn.value = "";
    };

    function renderMerge() {
      mList.innerHTML = mergeFiles.map((f, i) => `
        <div class="bg-white p-3 rounded border flex justify-between items-center">
            <span class="truncate">${f.name}</span>
            <button onclick="removeMergeFile(${i})" class="text-red-500 text-sm font-bold ml-2">Remove</button>
        </div>`).join("");
      mBtn.disabled = mergeFiles.length < 2;
    }

    window.removeMergeFile = (index) => {
        mergeFiles.splice(index, 1);
        renderMerge();
    }

    mBtn.onclick = async () => {
      showLoader("Merging PDFs...");
      try {
          const out = await PDFDocument.create();
          for (const f of mergeFiles) {
            const doc = await PDFDocument.load(await f.arrayBuffer());
            const pages = await out.copyPages(doc, doc.getPageIndices());
            pages.forEach(p => out.addPage(p));
          }
          saveFile(await out.save(), "merged.pdf");
      } catch (e) {
          console.error(e);
      }
      hideLoader();
    };

    /* ---------- SPLIT ---------- */
    const sIn = document.getElementById("splitIn");
    const sDrop = document.getElementById("splitDrop");
    const sBtn = document.getElementById("doSplit");

    sDrop.onclick = () => sIn.click();
    sIn.onchange = () => {
        if(sIn.files.length) sBtn.classList.remove("hidden");
    }

    sBtn.onclick = async () => {
      showLoader("Splitting...");
      try {
          const zip = new JSZip();
          const doc = await PDFDocument.load(await sIn.files[0].arrayBuffer());

          for (let i = 0; i < doc.getPageCount(); i++) {
            const sub = await PDFDocument.create();
            const [p] = await sub.copyPages(doc, [i]);
            sub.addPage(p);
            zip.file(`page-${i + 1}.pdf`, await sub.save());
          }

          const blob = await zip.generateAsync({ type: "blob" });
          saveFile(blob, "split.zip", true);
      } catch (e) {
          console.error(e);
      }
      hideLoader();
    };

    /* ---------- COMPRESS ---------- */
    const cIn = document.getElementById("compIn");
    const cDrop = document.getElementById("compDrop");
    const cBtn = document.getElementById("doComp");

    cDrop.onclick = () => cIn.click();
    cIn.onchange = () => {
        if(cIn.files.length) cBtn.classList.remove("hidden");
    }

    cBtn.onclick = async () => {
      showLoader("Compressing...");
      try {
          const doc = await PDFDocument.load(await cIn.files[0].arrayBuffer());
          saveFile(await doc.save({ useObjectStreams: true }), "compressed.pdf");
      } catch (e) {
          console.error(e);
      }
      hideLoader();
    };

    /* ---------- CONVERT ---------- */
    const cvIn = document.getElementById("convIn");
    const cvDrop = document.getElementById("convDrop");
    const cvBtn = document.getElementById("doConv");

    cvDrop.onclick = () => cvIn.click();
    cvIn.onchange = () => {
        if(cvIn.files.length) cvBtn.classList.remove("hidden");
    }

    cvBtn.onclick = async () => {
      showLoader("Extracting text...");
      try {
          const pdf = await pdfjsLib.getDocument(await cvIn.files[0].arrayBuffer()).promise;
          let text = "";

          for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            const content = await page.getTextContent();
            text += content.items.map(x => x.str).join(" ") + "\n";
          }

          saveFile(new Blob([text], { type: "text/plain" }), "text.txt", true);
      } catch (e) {
          console.error(e);
      }
      hideLoader();
    };
</script>
</body>
</html>

            
